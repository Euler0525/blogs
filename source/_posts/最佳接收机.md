---
title: 最佳接收机
tags:
  - 最佳接收机
  - 匹配滤波器
categories: 通信
mathjax: true
abbrlink: b120f60f
date: 2023-12-13 16:12:32
---

## 最大后验概率准则(MAP)

对于数字通信系统来说，可靠性的评价标准是 **误码率**，接收机要做的是以最小的错误概率猜出接收到的比特是 1 还是 0.

对于一个二进制传输系统来说，误码率定义为

$$
\begin{aligned}
P_e &= P(S_1)P(H_2|S_1) + P(S_2)P(H_1|S_2)\\
&=  P(S_1)\int_{x\in R_2}f(x|S_1)dx + P(S_2)\int_{x\in R_1}f(x|S_2)dx\\
&=  P(S_1)\int_{x\in R_2}f(x|S_1)dx + P [S_2](1 - \int_{x\in R_2}f(x|S_2) dx)\\
&(R_1 \cup R_2 = R)\\
& = P(S_2) + P(S_1)\int_{x\in R_2}f(x|S_1)dx - P(S_2)\int_{x\in R_2}f(x|S_2)dx\\
&= P(S_2) + \int_{x\in R_2}[P(S_1)f(x|S_1) - P(S_2)f(x|S_2)] dx\\
\end{aligned}
$$

其中 $P(S_1)$ 和 $P(S_2)$ 是发送集合元素的 **先验概率**，$P(H_2|S_1) = \displaystyle\int_{x\in R_2}f(x|S_1)dx$ 为发送 $S_1$ 时，接收信号条件概率密度函数在判决区域 $R_2$ 的积分，$P(H_1|S_2)$ 同理。

最后，在先验概率一定的情况下，要想使得误码率 $P_e$ 最小，需要让 $P(S_1)f(x|S_1) - P(S_2)f(x|S_2)$ 越小越好，最好是绝对值很大的负数，于是得到条件

$$
\begin{aligned}
P(S_1)f(x|S_1) &\leq P(S_2)f(x|S_2)
\iff \frac{P(S_1)f(x|S_1)} {f(x)} \leq \frac{P(S_2)f(x|S_2)} {f(x)}\\
\iff P(S_1|x) &\leq P(S_2|x)\\
\end{aligned}
$$

这种判定方法称为 **最大后验概率准则 MAP**.也就是说，最佳接受机可以等效于一个 **<u>AP计算器+比较器</u>**。

## 最佳接收机

某数字通信系统如下：

- 发送端发射 $M$ 元波形为 $\{s_1(t), s_2(t), \cdots, s_M(t)\}$；
- 经过高斯白噪声信道（$x(t)$ 双边功率谱密度为 $\frac{n_0} {2}$），得到接收信号位 $r(t) = s_m(t) + x(t)$

现在要设计一个接收机结构，使得接收错误概率最小。执行如下操作，若

$$
P(s_n(t)|r(t)) \geq P(s_m(t)|r(t))
$$

判定接收到的符号为 $s_n(t)$.

---

下面使用“采样法”计算波形与波形的后验概率：

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube@master/ct/khdlbq.webp" width="60%" height="60%"/>

如图，经过一个通带增益为 $1$，通带为 $|f| \leq \dfrac{f_{s}}{2}$ 的抗混叠滤波器，再经过采样以后，得到的波形变为离散序列 $r[n]=r(t)|_{t=nT_s}$，每个时域采样点可以表示为 $r[n] = s(nT_s) + x(nT_s) = s[n] + x[n]$.

其中，随机变量 $x[n]$ 服从高斯分布，$\sigma^2 = \dfrac{n_0} {2T_s}$，且 $\{x[n]|n=1,2,\cdots, N\}$ 相互独立

于是，随机变量 $r[n]$ 的 $N$ 维随机概率密度函数为

$$
f(r|s_m) = (\frac{1} {\sqrt{2\pi}\sigma})^N\cdot e^{-\tfrac{\sum_{n = 1}^{N}[r[n]-s_m [n]]^2} {2\sigma^2} }
$$

后验概率可以表示为

$$
P(s_m|r) = \frac{f(r|s_m)P(s_m)} {f(r)}
$$

要对 $\{P(s_m|r)|n = 1,2,\cdot, M\}$（$M$ 表示 $M$ 元波形）进行 $AP$ 比较，不妨忽略与 $m$ 无关的项，于是后验概率的比较可以改为比较

$$
\begin{aligned}
f(r|s_m)P(s_m)
&\rightarrow \ln{[f(r|s_m)P(s_m)]}\\
&= \ln f(r|s_m) + \ln P(s_m)\\
&= N \ln{\frac{1} {\sqrt{2\pi}\sigma} } - \frac{1} {2\sigma^2} \sum_{n = 1}^{N}[r[n]-s_m [n]]^2 + \ln P(s_m)\\
&= N \ln{\frac{1} {\sqrt{2\pi}\sigma} } - \frac{T_s} {n_0} \sum_{n = 1}^{N}[r[n]-s_m [n]]^2 + \ln P(s_m)\\
\end{aligned}
$$

去掉与 $m$ 无关的项，得到

$$
\begin{aligned}
f(r|s_m)P(s_m) &\propto -\frac{1} {n_0} \sum_{n = 1}^{N}[r[n]-s_m [n]]^2 T_s + \ln P(s_m)\\
&（K \to \infty , T_s \to 0）\\
f(r|s_m)P(s_m) &\propto -\frac{1} {n_0} \int_{0}^{T}[r(t)-s_m(t)]^2dt + \ln P(s_m)\\
& \propto \int_{0}^{T}r(t)s_m(t)dt - \frac{\int_{0}^{T}s_m^2(t)dt} {n_0} + \ln P(s_m)\\
\end{aligned}
$$


> 之前为了计算波形与波形的后验概率，用到了抗混叠滤波器，上式计算时将采样周期趋向于 $0$，也就是说不再需要<u>抗混叠滤波器</u>。

---

经过一番推导，收到接收信号 $r(t)$ 后，对 $m$ 个 $P(s_m|r)$ 进行比较，等效于比较

$$
\int_{0}^{T}r(t)s_m(t)dt - \frac{\varepsilon_m} {n_0} + \ln P(s_m), \varepsilon_m = \int_{0}^{T}s_m^2(t)dt
$$

据此构造出相关接收机结构为

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube@master/ct/mer.webp" width="80%" height="80%"/>

- 各元素有相同能量 → 步骤 Ⅱ 可以省略；
- 各元素先验概率相等 → 步骤 Ⅲ 可以省略；

## 基于匹配滤波器的最佳接受机

将 **<u>相关器</u>** 用 **<u>匹配滤波器+采样</u>** 代替，即上面的步骤 Ⅰ 使用

$$
h_m(t) = s_m(T - t)\rightarrow Sample_{(t = T)}
$$

相关器的输出信噪比仍满足 $\frac{E_s} {n_0/2}$.
