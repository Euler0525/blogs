---
title: 正交频分复用
tags:
  - OFDM
  - 循环卷积
categories: 通信
mathjax: true
abbrlink: ac1e42cd
date: 2024-03-12 17:42:48
---

# 正交频分复用(OFDM)

## 频率选择性衰落

发送端喝接收端之间有多条路径，每条路径的衰减不同，时延不同。设发送端发射信号为$f(t)$，接收端收到的信号
$$
\begin{aligned}
r(t) &= Af(t-\tau_0) + A_1f(t-\tau_0 - \tau_1)\\
R(\omega) &= A_0F(\omega)e^{-j\omega \tau_0} + A_1F(\omega)e^{-j\omega(\tau_0+\tau_1)} + \cdots\\
\end{aligned}
$$
则信道的频谱函数为
$$
H(\omega) = A_0e^{-j\omega\tau_0} + A_1e^{-j\omega(\tau_0+\tau_1)} + \cdots\\
$$
假设传播的路径只有两条，
$$
H(\omega) = e^{-j\omega\tau_0}(A_0 + A_1e^{-j\omega\tau_1})\\
$$
由上式可知$|H(\omega)|$随着$\omega$变化而变化，表现为频率选择性衰落。如果信号带宽大于信道带宽，一些频率的信号被严重衰减，使得整体信号发生畸变。

## OFDM的正交性

如果信号带宽小于信道带宽，那么传输过程中受到的信道的传输函数是相似的，没有频率选择性衰落，但是信号带宽小，传输速率低。

宽带通信要克服**信号带宽大于信道带宽**的情况。为了既能高速传输数据，又能抵抗频率选择性衰落，可以将高速数据分成多个低速的多路数据，通过多路载波发送，到了接收端再合成一路。而一般的频分复用，频带利用率较低，正交频分复用使用尽可能紧邻的正交子载波，可以**提高频带利用率**，并且能够**对抗频率选择性衰落**。可以验证，下面一组载波是相互正交的
$$
1, cos\omega t, \cos2\omega t, \cdots, \cos{m\omega t},\cdots,
sin\omega t, \sin 2\omega t, \cdots, \cos{m\omega t},\cdots
$$

---

所以我们可以从这些载波中挑出一些构造OFDM：先将谁进行串并转换，将高速数据转化为多路低速数据，然后分别调制到不同的载波上，相加后经过信道送出；接收端使用相关接收（**对应子载波的信号相乘后才有输出，别的子载波信号与其正交，输出为$0$**）经过调制后，频谱被搬移到各载波的中心频率上，经过相加后，合成频谱如下图

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube@master/ct/ofdm1.webp" width="60%" height="60%"/>

```matlab
NoOfCarriers = 11;  % 载波数量（奇数）
iMin = -(NoOfCarriers-1)/2;   
iMax = (NoOfCarriers-1)/2;  
f = -10:0.01:10;               
fList = zeros(1,NoOfCarriers); 
cList = zeros(1,NoOfCarriers); 
for i=iMin:1:iMax
    fshift = i ;
    c = sinc(f - fshift);
    fList(i+NoOfCarriers) =  fshift;
    cList(i+NoOfCarriers) = max(c);
    plot(f,c,'linewidth',1.5);
    hold on;
    stem(i ,1,'r-','linewidth',1.5);
end
xlabel("频率 MHz"); grid(); hold off;
```

为了实现每个子信道频谱的最大值处，其它子信道频谱恰好为$0$，要满足**相邻子载波之间的频率间隔要等于输入码元持续时间的倒数**。

## OFDM调制与解调

将带宽为$B$的载波划分成$N$个带宽为$\Delta f = \dfrac{B}{N}$的正交子载波，如果第一个载波的中心频率是$f_0$，第$n$个载波的中心频率是$f_n = f_0 + (n-1)\Delta f$，将符号$X_n$调制到第$n$个载波上。得到传输符号$X_ne^{j2\pi f_nt}$，累加所有载波上的信号得到最终的发送信号
$$
f(t) = \displaystyle\sum_{n=1}^N{X_n e^{j2\pi f_n t}} = e^{2\pi f_0 t}\displaystyle\sum_{n=1}^{N-1} X_ne^{j2\pi n \Delta ft}
$$

当接收端接收到信号$f(t)$后，可以采用以下方法确定载波$n$上的符号$X_n$.
$$
\begin{aligned}
\Delta f\int_0^{1/\Delta f}f(t)e^{-j2\pi f_n t}dt &= \Delta f\int_0^{1/\Delta f} \displaystyle\sum_{n=1}^N{X_n e^{j2\pi f_n t}} e^{-j2\pi f_n t}dt\\
&= X_n + \displaystyle\sum_{k\not= n} \Delta f\int_0^{1/\Delta f} X_k e^{j2\pi f_k t}e^{-2\pi f_n t}dt\\
&= X_n\\
\end{aligned}
$$
其中$f(t)=e^{2\pi f_0 t}\displaystyle\sum_{n=1}^{N-1} X_ne^{j2\pi n \Delta ft}$可以视为对基带信号$\hat{f}(t)=\displaystyle\sum_{n=1}^{N-1} X_ne^{j2\pi n \Delta ft}$在发射前的进一步载波调制，但是载波数量很大时，产生$\hat{f}(t)$的成本很高，需要使用时间间隔为$T=\dfrac{1}{B}$对其采样，第$l$个采样样本为
$$
\begin{aligned}
\hat{f}(lT) &= \displaystyle\sum_{n=1}^{N}X_n e^{j2\pi n \Delta flT}\\
&= \displaystyle\sum_{n=1}^{N}X_n e^{j2\pi n \frac{B}{N}l\frac{1}{B}}\\
&= \displaystyle\sum_{n=1}^{N}X_n e^{j2\pi \frac{nl}{N}}\\
\end{aligned}
$$
在OFDM中传输的是对连续信号$\hat{f}(t)$的$N$个采样点，当接收端接收到$\{\hat{f}(1),\hat{f}(2),\cdots, \hat{f}(N)\}$，对这$N$个点做离散傅里叶变换后得到序列$X_1,X_2,\cdots, X_n$

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube@master/ct/ofdm2.webp" width="80%" height="80%"/>

## 循环前缀

### 多径效应的影响

信号通过多径传输时，信道长度不同，到达接收端的时间不同，可能造成码间串扰。（假设发射信号为$x[n]|_0^{N-1}$，信道为$h[n]|_0^{\mu}$，当信号通过信道后，接收端得到$y[n] = x[n]*h[n]$，长度为$N+\mu$，接收端在处理了$N$个信号时，还有$\mu$个未处理，此时又收到来自发送端的信号，对第一个信号产生影响。）

> **循环卷积**：$y[n]=x[n]\otimes h[n] = \displaystyle\sum_{n=0}^{N-1} x[m]h[[n-m]]_N R_N[n]$
>
> 当$N=L_1+L_2-1$时，循环卷积与线性卷积结果相同。
>
> 在OFDM中，符号$X_k$经过IFFT后变成$\hat{f}[n]$，经过信道后，接受端接收$y[n] = f[n]*h[n]$，如果将线性卷积变为循环卷积，就可以利用DFT得到$Y(k)=X(k)H(k)$，其中$H(k)$可以利用信道估计得到。

### 循环前缀

设发送信号的长度为$N$，信道响应的长度为$\mu+1$循环前缀的长度为$l$，则接收端接收的信号长度为$N+\mu+l$，如果$l>\mu$，接收得到$y[n]$不受ISI的影响。

第二个信号加长$\mu$（将发射信号$x[n]$的后$\mu$个复制到$x[n]$的前面）时得到新的信号$x_1[n]$
$$
\{x[X-\mu],\cdots, x[N-1], x[0], x[1], \cdots,x[N-2], x[N-1]\}
$$

$$
\begin{aligned}
y[n] &= x_1[n] * h[n]\\
&= \sum_{m=0}^{\mu} h[m]x_1[n-m]\\
&= \sum_{m=0}^{\mu} h[m]x_1[[n-m]]_NR_N[n]\\
&= h[n] \otimes x[n]\\
\end{aligned}
$$

## 参考资料

- Yong Soo Cho等. MIMO-OFDM无线通信技术及MATLAB实现[M]. 北京: 电子工业出版社, 2013.

- 仿真：https://www.sharetechnote.com/html/Communication_OFDM.html
- 调制与解调：https://zhuanlan.zhihu.com/p/137712898
