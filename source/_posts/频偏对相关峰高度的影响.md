---
title: 频偏对相关峰高度的影响
tags:
  - 接收机
  - 多普勒效应
  - 相关
categories: 通信
mathjax: true
abbrlink: fe25307b
date: 2025-07-26 22:02:35
---

在接收机的捕获模块中，以相关峰高度作为捕获性能的衡量指标，当接收信号的相位与本地码相位对齐时，相关运算的结果会出现较大的相关峰，但如果存在频偏，会导致相关峰高度下降。下面推导相关峰高度与频偏的关系：

设捕获模块的输入信号的一个符号为 $r$，它被扩展为 $N$ 个码片，忽略随机时延，即与本地 PN 码相位对齐时，时域表达式为

$$
    r(n) = s(n) e^{j2\pi\Delta f n T_s} + w(n) \\
    \label{acq_din}
$$


式中，$s(n)$ 表示本地参考信号，$w(n)$ 表示离散的加性高斯白噪声，$\Delta f$ 表示频偏，$T_s=\dfrac{1}{f_s}$ 表示采样周期。

$$
s(n) = \left\{
\begin{aligned}
     & A, 0\leq n\leq N - 1 \\
     & 0, else
\end{aligned}
\right.
$$

捕获的输入信号与本地参考信号的相关结果为

$$
R(\Delta f) = \sum_{n = 0}^{N - 1} r(n)\cdot s^*(n)\\
$$

忽略噪声项

$$
R(\Delta f) = \sum_{n = 0}^{N - 1} |s(n)|^2 e^{j2\pi \Delta f n T_s}\\
$$

$|s(n)|^2 = A^2$，带入上式中得

$$
\begin{aligned}
R(\Delta f) &= A^2 \sum_{n = 0}^{N - 1} e^{j2\pi \Delta f n T_s}\\
&= A^2\dfrac{1 - e^{j2\pi \Delta f T_s N}}{1 - e^{j2\pi\Delta f T_s}}\\
&= A^2 e^{j\frac{2\pi \Delta f T_s}{2}(N - 1)}\dfrac{\sin{(\frac{2\pi\Delta f T_s}{2}N})}{\sin{(\frac{2\pi\Delta f T_s}{2}})}\\
\end{aligned}
$$

$$
|R(\Delta f)|  = A^2 \left| \dfrac{\sin{(\frac{2\pi\Delta f T_s}{2}N})}{\sin{(\frac{2\pi \Delta f T_s}{2}})}\right|
$$


当 $\Delta f $ 远小于采样率 $f_s$ 时，$|R(\Delta f)|$ 近似为

$$
\begin{aligned}
\lim_{\Delta f \to 0} { |R(\Delta f)| } & = A^2 N \dfrac{ \sin{(\pi \Delta f T_s N)} }{ \pi \Delta f T_s N }\\
& = |R(0)| \cdot |\text{sinc}{(\pi \Delta f T_s N)}|\\
\end{aligned}
$$

当 $\Delta f = 0$ 时，峰值位置 $|R(0)| = A^2N$，零点位置对应

$$
\Delta f = \dfrac{k}{T_s N} = \dfrac{kf_s}{N}, k = \pm1, \pm 2, \cdots\\
$$

由此可以得出，相关峰随频偏的变化满足 $\text{sinc}$ 函数，并且当频偏为 $R_s$ 的整数倍时，相关峰高度为 $0$，MATLAB 仿真结果如图所示

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/corr_peak_01.webp" width="80%;" />

在捕获模块频偏搜索的精度选择上，如果以 $R_s$ 为步进设置频偏通道，在 $0.5R_s$ 的奇数倍时相关峰高度最低，为无频偏位置的 $63.66\%$，性能损失较大，如果以 $0.5R_s$ 为步进设置频偏通道，在 $0.25R_s$ 的奇数倍时相关峰高度最低，为无频偏位置的 $90.03\%$，性能损失较低，因此，综合捕获性能与资源消耗的考量，选择以 $0.5R_s$ 作为频偏搜索精度。
