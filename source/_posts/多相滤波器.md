---
title: 多相滤波器
tags:
  - 滤波器
categories: 信号处理
mathjax: true
abbrlink: 1c9534be
date: 2025-03-05 11:00:17
---

# 多相滤波器

多相滤波器常用语多速率数字信号处理系统。

> 假设要对输入数据序列进行$M$倍下采样，为了避免频谱展宽导致的混叠，首先要进行抗混叠滤波，然后对滤波结果进行下采样，显然，滤波输出中每$M$个数据就有$M-1$个数据会被丢弃，也就是说，针对这$M-1$个数据的滤波处理是浪费的，多相滤波器就是为了解决这一计算浪费问题而设计的。
>
> 假设要对输入数据进行$M$倍上采样，在上采样之后，需要进行滤波处理以消除镜像，一般做法是先进行插零上采样，然后进行滤波。采用多相滤波器可以颠倒采样和滤波的顺序以降低运算量。

## 诺贝尔恒等变换

在对滤波器进行适当变形分解后，可以交换上/下采样处理和滤波处理的顺序，并且保证处理结果一致。

## 多相分解

### Ⅰ型多相分解

设输入信号为$x(n)$，滤波器冲激响应为$h(n)$，先进性抗混叠滤波再进行下采样处理，过程如下
$$
\begin{aligned}
y(n) &= \sum_k x(k) h(n - k) = \sum_k h(k) x(n - k) \\
y_M(n) &= y(Mn) = \sum_k x(k)h(nM - k) = \sum_k h(k) x(nM - k)\\
\end{aligned}
$$

$$
\begin{aligned}
y_M(0) &= y(0) = x(0)h(0)\\
y_M(1) &= y(M) = h(0)x(M) + h(1)x(M-1) + \cdots + h(M)x(0)\\
&\vdots\\
y_M(n) &= y(nM) = h(0)x(nM) + h(1)x(nM-1) + \cdots + h(nM)x(0)\\
&= \Big[ h(0)x(nM) + h(M)x((n-1)M) + \cdots + h(nM)x(0) \Big] + \\
&\quad \Big[ h(1)x(nM - 1) + h(1 + M)x((n-1)M - 1) + \cdots + h((n - 1)M + 1)x(M - 1) \Big] + \\
&\quad \Big[ h(M-1)x(nM - (M-1)) + h(2M - 1)x(nM - (2M - 1)) + \cdots + h(nM - 1)x(1) \Big] \\
&= \sum_{k=0}^n h(kM)x((n - k)M) + \\
&\quad \sum_{k=0}^{n-1} h(kM + 1)x((n - k)M - 1) + \\
&\quad \vdots \\
&\quad \sum_{k=0}^{n-1} h(kM + (M-1))x((n - k)M - (M-1))\\
&= \sum_{m=0}^{M-1}\left(\sum_{k=0}^n h(kM+m)x((n-k)M - m)\right)
\end{aligned}
$$

数字滤波器$H(z) = \displaystyle\sum_{k=-\infty}^{+\infty}h(k)z^{-k}$，定义$e_n(r) = h(rM+n), n = 0, 1, \cdots, M-1$，称$e_n(r)$为$h(k)$的第$n$个分组，

令$k=rM+n, n = 0,1,\cdots, M-1$，则
$$
\begin{aligned}
H(z) &= \sum_{n=0}^{M-1}\sum_{r=-\infty}^{+\infty} h(rM+n)z^{-(rM+n)}\\
&= \sum_{n=0}^{M-1}\left(\sum_{r=-\infty}^{+\infty} e_n(r)z^{-rM}\right)z^{-n}\\
\end{aligned}
$$
若$E(z) = \displaystyle\sum_{k=-\infty}^{+\infty}e_n(k)z^{-k}$，则称$E_n(z)$为$H(z)$的第$n$个多相分量，
$$
\begin{aligned}
H(z) &= \sum_{n=0}^{M-1}E_n(z^M)z^{-n}\\
&=E_0(z^M) + E_1(z^M)z^{-1} + \cdots + E_{M-1}(z^M)z^{-(M-1)}\\
&= 
\begin{bmatrix}
1 & z^{-1} & \cdots & z^{-(M-1)}
\end{bmatrix}
\begin{bmatrix}
E_0(z^M)\\E_1(z^M)\\ \vdots\\ E_n(z^M)
\end{bmatrix}
\end{aligned}
$$

> 将$h$均分为$M$组，除$M$余$n$的分在一组，e.g.
>
> 已知$7$阶数字滤波器单位脉冲响应为$h(k)=\{1,2,3,4,5,6,7\}$，求$M=2$时的多相分解
> $$
> \begin{aligned}
> e_0(k) &= \{1, 3, 5, 7\}, &E_0(z) = 1 + 3z^{-1} + 5z^{-2} + 7z^{-3}\\
> e_1(k) &= \{2, 4, 6, 8\}, &E_1(z) = 2 + 4z^{-1} + 6z^{-2} + 8z^{-3}\\
> \end{aligned}
> $$
>
> $$
> \begin{aligned}
> H(z) &= 1 + 2z^{-1} + 3z^{-2} + \cdots + 7z^{-6}\\
> &=E_0(z^2) + E_1(z^2)z^{-1}\\
> &=(1 + 3z^{-2} + 5z^{-4} + 7z^{-6}) + (2 + 4z^{-2} + 6z^{-4} + 8z^{-6})z^{-1}\\
> \end{aligned}
> $$

### Ⅱ型多相分解

$$
H(z) = \sum_{n=0}^{M-1}E_n(z^M)z^{-n}
$$

令$R_n(z) = E_{M-1-n}(z), n = 0, 1, \cdots, M-1$，得到Ⅱ型多相分解
$$
\begin{aligned}
H(z) &= \sum_{n=0}^{M-1} R_n(z^M)z^{-(M-1-n)}\\
&= R_0(z^M)z^{-(M-1)} + R_1z^{-(M-2)} + \cdots + R_{M-1}(z^M)\\
&= 
\begin{bmatrix}
z^{-(M-1)} & z^{-(M-2)} & \cdots & 1\\
\end{bmatrix}
\begin{bmatrix}
R_0(z^M)\\R_1(z^M)\\ \vdots\\ R_n(z^M)
\end{bmatrix}\\
\end{aligned}
$$

## 滤波器结构

- Ⅰ型分解

$$
\begin{aligned}
H(z) &= \sum_{n=0}^{M-1}E_n(z^M)z^{-n}\\
&=E_0(z^M) + E_1(z^M)z^{-1} + \cdots + E_{M-1}(z^M)z^{-(M-1)}\\
&= 
\begin{bmatrix}
1 & z^{-1} & \cdots & z^{-(M-1)}
\end{bmatrix}
\begin{bmatrix}
E_0(z^M)\\E_1(z^M)\\ \vdots\\ E_n(z^M)
\end{bmatrix}
\end{aligned}
$$

![Ⅰ型分解](https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/poly_1.webp)

- Ⅱ型分解，$R_n(z) = E_{M-1-n}(z), n = 0, 1, \cdots, M-1$

$$
\begin{aligned}
H(z) &= \sum_{n=0}^{M-1} R_n(z^M)z^{-(M-1-n)}\\
&= R_0(z^M)z^{-(M-1)} + R_1z^{-(M-2)} + \cdots + R_{M-1}(z^M)\\
&= 
\begin{bmatrix}
z^{-(M-1)} & z^{-(M-2)} & \cdots & 1\\
\end{bmatrix}
\begin{bmatrix}
R_0(z^M)\\R_1(z^M)\\ \vdots\\ R_n(z^M)
\end{bmatrix}\\
\end{aligned}
$$

![Ⅱ型分解](https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/poly_2.webp)

## 参考资料

[Multirate Noble Identities](https://ccrma.stanford.edu/~jos/sasp/Multirate_Noble_Identities.html)

[多相抽取器实现及matlab示例](https://blog.csdn.net/chenxy_bwave/article/details/119104049)

[[数字信号处理] 第7章 7-4-1 数字滤波器结构的I型多相分解](https://www.bilibili.com/video/BV1xd4y1Z7ec/?spm_id_from=333.337.search-card.all.click&vd_source=73283a904d0283e872302ad0b415f303)

[[数字信号处理] 第7章 7-4-2 数字滤波器结构的II型多相分解](https://www.bilibili.com/video/BV1Qg4y1V7x9?spm_id_from=333.788.player.switch&vd_source=73283a904d0283e872302ad0b415f303)
