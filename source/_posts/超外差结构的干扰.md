---
title: 超外差结构的干扰
tags:
  - AD9361
  - 镜频干扰
  - 三阶交调
  - IQ失衡
  - 超外差
categories: 射频
mathjax: true
abbrlink: f173e9aa
date: 2024-08-03 10:42:11
---

# 超外差结构的干扰

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/superheterodyne_transmitter.webp" alt="superheterodyne_transmitter" width="90%" height="80%"/>

<center><small>图1 超外差发射机模型图</small></center>

## 镜频干扰

首先只考虑发送$I$路的情况，
$$
\begin{aligned}
I\cos 2\pi f_{IF}t\cdot\cos2\pi f_{LO}t &= \frac{1}{2}I\cos(2\pi (f_{LO}+f_{IF})t) + \frac{1}{2}I\cos(2\pi (f_{LO}-f_{IF})t)\\
&=\frac{1}{2}I[\cos(2\pi (f_{LO}+f_{IF})t) + \cos(2\pi (f_{LO}-f_{IF})t)]
\end{aligned}
$$
其中$f_{LO}$为本振频率，$f_{IF}$为中频，信号频率$f_{RF} = f_{LO}-f_{IF}$，在频谱仪上观察射频信号的频谱图，会发现关于$f_{LO}$对称的两个频率分量，如下图所示

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/image_inter_ad.webp" alt="image_inter_ad" width="60%" height="75%"/>

<center><small>图2 镜频干扰与交调干扰的现象</small></center>

> 镜像现象的MATLAB仿真代码：
>
> ```matlab
> close all;clear;clc;
> 
> freq_baseband = 10e6;
> freq_carrier = 50e6;
> fs = freq_carrier * 8;
> t = 0:1/fs:1e-5;
> baseband_i = cos(2 * pi * t * freq_baseband);
> carrier_i = cos(2 * pi * t * freq_carrier);
> baseband_i = [baseband_i, zeros(1, 10000)];  % Suppress the fence effect(≧∇≦)ﾉ
> carrier_i = [carrier_i, zeros(1, 10000)];
> rf_i = baseband_i .* carrier_i;
> figure();
> subplot(121);
> plot(abs(fftshift(fft(baseband_i))));
> subplot(122);
> plot(abs(fftshift(fft(carrier_i))));
> figure();
> plot(abs(fftshift(fft(rf_i))));
> ```

## 交调干扰

上图中除了$f_{LO}-f_{IF}$和$f_{LO}-f_{IF}$分量外，还有其它的频率分量，这是由于交调干扰导致的。

忽略更高阶的非线性，仅将射频$PA$的非线性特性用三阶幂级数简单表示为
$$
\begin{aligned}
\begin{aligned}
s = &A_1[\cos{(f_{LO} + f_{IF}) + \cos{(f_{LO}-f_{IF})}} + \alpha\cos f_{LO}] \\&+ A_2[\cos{(f_{LO} + f_{IF}) + \cos{(f_{LO}-f_{IF})}}+ \alpha\cos f_{LO}]^2 \\&+ A_3[\cos{(f_{LO} + f_{IF}) + \cos{(f_{LO}-f_{IF})}}+ \alpha\cos f_{LO}]^3\\
&+\cdots\\
= &(A_1+\dfrac{3}{4}\alpha^3A_3 + \dfrac{9}{2}\alpha A_3)\cos{f_{LO}}\\
&+(A_1+\dfrac{9}{4}A_3+\dfrac{9}{4}\alpha^2 A_3)\cos{(f_{LO}+f_{IF})}+(A_1+\dfrac{9}{4}A_3+\dfrac{9}{4}\alpha^2 A_3)\cos{(f_{LO}-f_{IF})}\\
&+\dfrac{9}{4}\alpha A_3\cos{(f_{LO}+2f_{IF})}+\dfrac{9}{4}\alpha A_3\cos{(f_{LO}-2f_{IF})}\\
&+\dfrac{3}{4}A_3\cos{(f_{LO}+3f_{IF})}+\dfrac{3}{4}A_3\cos{(f_{LO}-3f_{IF})}\\
&+\cdots
\end{aligned}
\end{aligned}
$$

> 本实验使用的DDS IP核输出位宽为32位，为排除[DDS量化误差](https://euler0525.github.io/blogs/posts/c8c59f13/#dds%E7%9A%84%E5%B9%85%E5%BA%A6%E9%87%8F%E5%8C%96%E8%AF%AF%E5%B7%AE)引起的杂散，将DDS输出的信号导入到MATLAB中分析频谱
>
> <img src="https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/img-dds.jpg" alt="img-dds" width="75%" height="75%"/>
>
> 如图所示，几乎没有图2中大功率的杂波出现，因此可以排除DDS幅度量化误差这一因素。

## IQ失衡（IQ imbalance）

> [IQ调制](https://euler0525.github.io/blogs/posts/bd1f7a33/)

在只发$I$路信号时，镜像分量的频谱图关于$f_{LO}$对称，当$IQ$两路同时发单音信号时，现象为

<img src="https://cdn.jsdelivr.net/gh/Euler0525/tube/ct/iq-imbalance.webp" alt="iq-imbalance" width="60%" height="75%"/>

<center><small>图3 IQ失衡的现象</small></center>

如图1所示，按照数字信号处理的理论，IQ调制的结果为$I\cos{2\pi f_{IF}t}+Q\sin{2\pi f_{IF}t}$，但实际上，正交调制与解调通过模拟电路实现，IQ两路的信号很难做到幅度相等、完全正交，因此会造成幅度和相位的失衡，将载波表达式修正为
$$
carrier = \cos(2\pi f_{IF}t) + j(1+\alpha)\sin(2\pi f_{IF} + \varphi)
$$
则IQ调制的结果变为
$$
I\cos{2\pi f_{IF}t}+Q(1+\alpha)\sin{(2\pi f_{IF}t+\varphi)}
$$
经过混频后，忽略PA的非线性因素，其输出为
$$
\begin{aligned}
s = &I\cos(f_{LO}+f_{IF}) + I\cos(f_{LO}-f_{IF})\\
&+Q(1+\alpha)\sin{(f_{LO}+f_{IF}+\varphi)}+Q(1+\alpha)\sin{(f_{LO}+f_{IF}+\varphi)}
\end{aligned}
$$
在频谱仪上能观察到的频率分量为
$$
(I+Q(1+\alpha))e^{f_{LO}+f_{IF}} + (I-Q(1+\alpha))e^{j(f_{LO}-f_{IF})}
$$
关于本振频率对称的两个分量的幅度不相等。

## 参考资料

[接收机IQ不平衡：估计和纠正 (Rx IQ imbalance: Estimation and Correction)](https://blog.csdn.net/chenxy_bwave/article/details/120688218)

默默感谢实验室诸位师兄师姐的答疑解惑！！！
