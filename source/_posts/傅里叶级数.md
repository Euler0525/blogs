---
title: 傅里叶级数
tags:
  - 傅里叶级数
categories: 信号处理
mathjax: true
abbrlink: 12c7172f
date: 2024-01-18 17:00:03
---

## 信号在正交集中的分解

### 矢量分解

为了方便理解，先从矢量分解说起，

**单矢量基底**

如左图，使 $\lambda_1\overrightarrow{x_1}$ 近似于矢量 $\overrightarrow{a}$，误差尽可能的小（定义误差为 $\overrightarrow{a-\lambda_1 x_1}$ 的模长），可以得到使误差最小的系数为

$$
\lambda_1 = \dfrac{\overrightarrow{a}\cdot\overrightarrow{x_1}}{\overrightarrow{x_1}\cdot\overrightarrow{x_1}}
$$

如果系数 $\lambda = 0$，则说明 $\overrightarrow{a}$ 与 $\overrightarrow{x_1}$ 垂直（正交）。

**多矢量基底**

为了将误差进一步缩小，现在用多个矢量的线性组合近似表示矢量 $\overrightarrow{a}$

$$
a = \sum_{i = 1}^{n}\lambda_i x_i
$$

一般情况下，如果 $\overrightarrow{x_i}$ 的方向未知，某一个矢量基底的系数不仅与这个矢量有关，还与其它矢量基底的角度有关；如果满足矢量 $\overrightarrow{x}$ 两两正交，则可以证明 $\lambda_i = \dfrac{\overrightarrow{a}\cdot\overrightarrow{x_i}}{\overrightarrow{x_i}\cdot\overrightarrow{x_i}}$

### 信号分解

与矢量分解类似推导信号分解

**单标准信号**

在时间范围 $(t_1, t_2)$ 内，用 $c_1f_1(t)$ 近似函数 $f(t)$，并使得误差最小

> 此处误差讨论方均误差 $\overline{\varepsilon^2(t)} = \dfrac{1}{t_2-t_1}\displaystyle \int_{t_1}^{t_2}\lvert\varepsilon(t)\rvert^2 dt = \dfrac{1}{t_2-t_1}\displaystyle \int_{t_1}^{t_2}\varepsilon(t)\cdot\varepsilon^*(t) dt$

与矢量分解类似，可以求得系数

$$
c_1 = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)f_1^*(t)dt}{\displaystyle\int_{t_1}^{t_2}f_1(t)f_1^*(t)dt}
$$

如果 $c=0$，则称函数 $f(t)$ 与 $f_1(t)$ 正交。

**多标准信号**

现在用多个标准信号的线性组合来近似表示信号 $f(t)$

$$
f(t) = \sum_{i = 1}^n c_i f_i(t)
$$

当 $f_i(t)$ 两两正交时，可以证明 $c_i = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)f_i^*(t)dt}{\displaystyle\int_{t_1}^{t_2}f_i(t)f_i^*(t)dt}$

综上，矢量与函数的运算和分解如下

|          |                             矢量                             |                             函数                             |
| :------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|  “乘法”  | $x_1\cdot x_2 = \lvert x_1 \rvert\cdot \lvert x_2 \rvert\cos \alpha$ |    $\displaystyle\int_{t_1}^{t_2}f_1(t)\cdot f_2^*(t)dt$     |
|   正交   |                      $x_1\cdot x_2 =0$                       |   $\displaystyle\int_{t_1}^{t_2}f_1(t)\cdot f_2^*(t)dt=0$    |
|   误差   |                  $\varepsilon = x_1 - x_2$                   |              $\varepsilon(t) = f_1(t) - f_2(t)$              |
| 误差代价 |                 $\lvert\varepsilon\rvert^2$                  | $\overline{\varepsilon^2(t)} = \dfrac{1}{t_2-t_1}\displaystyle\int_{t_1}^{t_2}\lvert\varepsilon(t)\rvert^2 dt$ |
| 相似系数 | $\lambda_1 = \dfrac{\overrightarrow{a}\cdot\overrightarrow{x_1}}{\overrightarrow{x_1}\cdot\overrightarrow{x_1}}$ | $c_1 = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)f_1^*(t)dt}{\displaystyle\int_{t_1}^{t_2}f_1(t)f_1^*(t)dt}$ |

## 信号的傅里叶级数表示

### 三角函数形式的傅里叶级数表示

选择一个正交函数集 $\{1,\cos\omega t, \sin\omega t, \cos2\omega t,\sin2\omega t, \cdots, \cos k \omega t, \sin k\omega t\}$，其中 $\omega = \dfrac{2\pi}{T} = \dfrac{2\pi}{t_2-t_1}$

> 为什么不选泰勒级数呢，我算它应该是不正交的

下面说明该函数集的几个性质

1. 正交性：函数两两正交

$$
\begin{aligned}
&\displaystyle\int_{t_1}^{t_2}\cos(m\omega t)\sin(n\omega t)dt = 0\\
&\left.
\begin{aligned}
\displaystyle\int_{t_1}^{t_2}\cos(m\omega t)\cos(n\omega t)dt = 0\\
\displaystyle\int_{t_1}^{t_2}\sin(m\omega t)\sin(n\omega t)dt = 0\\
\end{aligned}
\quad \right\}m\not = n
\end{aligned}
$$

2. 当 $n\not=0$ 时，$\displaystyle\int_{t_1}^{t_2}\cos^2(n\omega t)dt = \displaystyle\int_{t_1}^{t_2}\sin^2(n\omega t)dt = \dfrac{T}{2} = \dfrac{t_2 - t_1}{2}$；当 $n=0$ 时，$\displaystyle\int_{t_1}^{t_2}1dt = T = t_2 - t_1$

此时，可以将任意函数 $f(t)$ 在这个正交函数集中展开，即表示成多个正（余）弦函数的线性组合

$$
f(t) = a_0 + a_1\cos\omega t + a_2\cos2\omega t + \cdots + a_n\cos n\omega t + \cdots + b_1\sin\omega t + b_2\sin2\omega t  + \cdots + b_n \sin n\omega t + \cdots
$$

其中系数可以根据上文表格中的表达式求出

$$
\begin{aligned}
&a_n = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)\cos(n \omega t)dt}{\displaystyle\int_{t_1}^{t_2}\cos^2(n \omega t)dt}
= \left\{
\begin{aligned}
&\dfrac{2}{t_2 - t_1} \displaystyle\int_{t_1}^{t_2}f(t)\cos(n \omega t)dt &n \not = 0\\
&\dfrac{1}{t_2 - t_1} \displaystyle\int_{t_1}^{t_2}f(t)dt &n = 0
\end{aligned}
\right.\\
&b_n = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)\sin(n \omega t)dt}{\displaystyle\int_{t_1}^{t_2}\sin^2(n \omega t)dt} = \dfrac{2}{t_2 - t_1} \displaystyle\int_{t_1}^{t_2}f(t)\sin(n \omega t)dt
\end{aligned}
$$

不过，为了表达方便，可以将分解式改写为下面表达式（把直流分量 $a_0$ 改为 $\dfrac{a_0}{2}$）

$$
f(t) = \dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}(a_n \cos(n\omega t) + b_n\sin(n\omega t))
$$


则系数为

$$
\begin{aligned}
&a_n = \dfrac{2}{t_2 - t_1} \displaystyle\int_{t_1}^{t_2}f(t)\cos(n \omega t)dt\\
&b_n = \dfrac{2}{t_2 - t_1} \displaystyle\int_{t_1}^{t_2}f(t)\sin(n \omega t)dt
\end{aligned}
$$

表达式右边是多个周期为 $T$ 的函数的和，仍然是周期为 $T$ 的函数；这种分解可以用来研究时间区间 $(t_1, t_2)$ 内的信号分解，也可以研究周期为 $T$ 的函数在整个时间区间的信号分解。

---

令 $A_n = \sqrt{a_n^2 + b_n^2}, \varphi_n = -\arctan\dfrac{b_n}{a_n}$，则上面的分解可以表达为

$$
f(t) = \dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}A_n\cos(n\omega t + \varphi_n)
$$

可以将它看成是 $\{\cos(n\omega t)|n=0,1,2,3,\cdots \}$ 平移之后的线性组合。

> 不清楚为啥大学教材这么喜欢用 $\cos$ 函数，感觉相位前面加个负号就很奇怪

其中 $\dfrac{a_0}{2}$ 称为信号的直流分量，$a_1\cos\omega t,b_1\sin\omega t或A_1\cos(\omega t + \varphi_1)$ 称为信号的基波分量；$a_n\cos(n\omega t),b_n\sin(n\omega t)或A_n\cos(n\omega t + \varphi_n)$ 称为信号的 $n$ 次谐波分量。

### 复数形式的傅里叶级数表示

选择正交函数集为 $\{1,e^{j\omega t}, e^{h2\omega t}, \cdots, e^{jn\omega t}, \cdots\}$，得到级数展开式为

$$
f(t) = \displaystyle\sum_{n =-\infty}^{+\infty}(c_n\cdot e^{j(n\omega t)})
$$

得到其中的系数

$$
c_n = \dfrac{\displaystyle\int_{t_1}^{t_2}f(t)(e^{jn\omega t})^*dt}{\displaystyle\int_{t_1}^{t_2}(e^{jn\omega t})(e^{jn\omega t})^* dt} = \dfrac{1}{T}\displaystyle\int_{t_1}^{t_2} f(t) e^{-jn\omega t}dt
$$

> 推导过程如下：
>
> $$
> \begin{aligned}
> f(t) &= \dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}A_n\cos(n\omega t + \varphi_n)\\
> &=\dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}A_n\dfrac{e^{j(n\omega t + \varphi_n)} + e^{-j(n\omega t + \varphi_n)}}{2}\\
> &= \dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}(\dfrac{A_n}{2}e^{j(n\omega t + \varphi_n)} +\dfrac{A_n}{2} e^{j((-n)\omega t + (-\varphi_n)})\\
> 令\varphi_{-n} = -\varphi_n, A_{-n} = A_n，\\
> f(t) &= \dfrac{a_0}{2} + \displaystyle \sum_{n = 1}^{+\infty}\dfrac{A_n}{2}e^{j(n\omega t + \varphi_n)} + \displaystyle \sum_{n =-1}^{-\infty}\dfrac{A_n}{2}e^{j(n\omega t + \varphi_n)}\\
> 令\varphi_0 = 0, A_0 = a_0,\\
> f(t) &= \dfrac{1}{2} \displaystyle\sum_{n =-\infty}^{+\infty}(A_n e^{j\varphi_n} \cdot e^{j(n\omega t)})\\
> 其中，
> A_n e^{j\varphi_n} &= \sqrt{a_n^2 + b_n^2}(\cos\varphi_n + j\sin\varphi_n) \\
> &= a_n -jb_n\\
> &= \dfrac{2}{T}\displaystyle\int_{t_1}^{t_2}f(t)\cos(n \omega t)dt -j\dfrac{2}{T}\displaystyle\int_{t_1}^{t_2}f(t)\sin(n \omega t)dt\\
> &=\dfrac{2}{T}\displaystyle\int_{t_1}^{t_2}f [t](\cos(n\omega t) - j\sin(n\omega t))dt\\
> &= \dfrac{2}{T} \displaystyle\int_{t_1}^{t_2} f(t)e^{-jn\omega t}dt\\
> \end{aligned}
> $$
>

### 奇偶性

任何函数都可以写成奇函数和偶函数的和：

- 如果信号函数是偶函数，则傅里叶级数中只有直流分量和余弦分量；

- 如果信号函数是奇函数，则傅里叶级数中只有正弦分量；

- 奇谐函数的傅里叶记住中只有奇次谐波分量；偶谐函数的傅里叶级数中只有直流和偶次谐波分量。
